<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="account_check_printing.view_account_payment_form_inherited" model="ir.ui.view">
        <field name="name">account.payment.form.inherited</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='post']" position="replace">
                <button name="post" class="oe_highlight"
                        attrs="{'invisible': ['|',('payment_method_code', '=', 'pdc'), ('state',  'in', ['posted','sent','reconciled','cancelled'])]}"
                        string="Confirm" type="object"/>
                <button name="post" class="oe_highlight" states="pdc" string="Confirm" type="object"/>
            </xpath>
            <xpath expr="//button[@name='post']" position="before">
                <button name="process_pdc" class="oe_highlight"
                        attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['pdc']), ('state', '!=', 'draft')]}"
                        string="Process Pdc" type="object"/>
                <button name="print_checks" class="oe_highlight"
                        attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['check_printing','pdc']), ('state', '!=', 'posted')]}"
                        string="Print Check" type="object"/>
                <button name="unmark_sent"
                        attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['check_printing','pdc']), ('state', '!=', 'sent')]}"
                        string="Unmark Sent" type="object"/>
            </xpath>
            <xpath expr="//div[@name='amount_div']" position="after">
                <field name="check_amount_in_words"
                       attrs="{'invisible': [('payment_method_code', 'not in', ['check_printing','pdc'])], 'readonly': [('state', '!=', 'draft')]}"
                       groups="base.group_no_one"/>
            </xpath>
            <xpath expr="//field[@name='communication']" position="after">
                <field name="check_manual_sequencing" invisible="1"/>
                <field name="check_number"
                       attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['check_printing','pdc']), ('check_number', '=', 0)]}"/>
            </xpath>
            <xpath expr="//field[@name='payment_date']" position="after">
                <field name="effective_date"
                       attrs="{'invisible': [('payment_method_code', '!=', 'pdc')],'required': [('payment_method_code', '=', 'pdc')]}"/>
                <field name="bank_reference" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                <field name="cheque_reference" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                <field name="check_effective_date" invisible="1"/>
            </xpath>
        </field>
    </record>

    <record id="account_check_printing.view_account_payment_invoice_form_inherited" model="ir.ui.view">
        <field name="name">account.payment.invoice.form.inherited</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_invoice_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_validate_invoice_payment']" position="replace">
                <button name="action_validate_invoice_payment" class="btn-primary"
                        attrs="{'invisible': ['|',('payment_method_code', '=', 'pdc'), ('state',  'in', ['posted','sent','reconciled','cancelled'])]}"
                        string="Validate" type="object"/>
                <button name="action_validate_invoice_payment" class="btn-primary" states="pdc" string="Validate"
                        type="object"/>
            </xpath>
            <xpath expr="//button[@name='action_validate_invoice_payment']" position="after">
                <button name="process_pdc" class="oe_highlight"
                        attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['pdc']), ('state', '!=', 'draft')]}"
                        string="Process Pdc" type="object"/>
            </xpath>
            <xpath expr="//div[@name='amount_div']" position="after">
                <field name="check_amount_in_words"
                       attrs="{'invisible': [('payment_method_code', 'not in', ['check_printing','pdc'])]}"
                       groups="base.group_no_one"/>
            </xpath>
            <xpath expr="//field[@name='communication']" position="after">
                <field name="check_manual_sequencing" invisible="1"/>
                <field name="check_number"
                       attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['check_printing','pdc']), ('check_manual_sequencing', '=', False)]}"/>
            </xpath>
            <xpath expr="//field[@name='payment_date']" position="after">
                <field name="effective_date"
                       attrs="{'invisible': [('payment_method_code', '!=', 'pdc')],'required': [('payment_method_code', '=', 'pdc')]}"/>
                <field name="bank_reference" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                <field name="cheque_reference" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
            </xpath>
        </field>
    </record>
    <record id="account_check_printing.view_account_payment_from_invoices_inherited" model="ir.ui.view">
        <field name="name">account.register.payments.wizard.inherited</field>
        <field name="model">account.register.payments</field>
        <field name="inherit_id" ref="account.view_account_payment_from_invoices"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='amount']" position="after">
                <field name="check_amount_in_words"
                       attrs="{'invisible': [('payment_method_code', 'not in', ['check_printing','pdc'])]}"
                       groups="base.group_no_one"/>
            </xpath>
            <xpath expr="//field[@name='communication']" position="after">
                <field name="check_manual_sequencing" invisible="1"/>
                <field name="check_number"
                       attrs="{'invisible': ['|', ('payment_method_code', 'not in', ['check_printing','pdc']), ('check_manual_sequencing', '=', False)]}"/>
            </xpath>
            <xpath expr="//field[@name='payment_date']" position="after">
                <field name="effective_date"
                       attrs="{'invisible': [('payment_method_code', '!=', 'pdc')],'required': [('payment_method_code', '=', 'pdc')]}"/>
                <field name="bank_reference"/>
                <field name="cheque_reference"/>
            </xpath>
        </field>
    </record>
    <record id="account_check_printing.view_payment_check_printing_search" model="ir.ui.view">
        <field name="name">account.payment.check.printing.search</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_search"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='state_sent']" position="before">
                <filter string="Checks To Print"
                        domain="[('payment_method_id.code', 'in', ['check_printing','pdc']), ('state','=','posted')]"
                        name="checks_to_send"/>
            </xpath>
        </field>
    </record>
    <record id="view_account_payment_tree1" model="ir.ui.view">
        <field name="name">account.payment.tree</field>
        <field name="model">account.payment</field>
        <field name="arch" type="xml">
            <tree decoration-danger="(check_effective_date==True)"
                  decoration-muted="state in ['reconciled', 'cancelled']" edit="false" create="0">
                <field name="payment_date"/>
                <field name="name"/>
                <field name="journal_id"/>
                <field name="payment_method_id"/>
                <field name="effective_date"/>
                <field name="partner_id" string="Customer"/>
                <field name="amount" sum="Amount"/>
                <field name="state"/>
                <field name="company_id" groups="base.group_multi_company"/>
                <field name="currency_id" invisible="1"/>
                <field name="partner_type" invisible="1"/>
                <field name="check_effective_date" invisible="1"/>
            </tree>
        </field>
    </record>
    <record id="action_pdc_payments_purchase" model="ir.actions.act_window">
        <field name="name">PDC Payments</field>
        <field name="res_model">account.payment</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'search_default_payable_filter': 1}</field>
        <field name="domain">[('payment_method_code', '=', 'pdc'),('payment_type','=', 'outbound')]</field>
        <field name="view_id" ref="view_account_payment_tree1"/>
    </record>
    <menuitem id="menu_pdc_payment_purchase"
              action="action_pdc_payments_purchase" parent="account.menu_finance_payables_documents" sequence="21"/>
</odoo>